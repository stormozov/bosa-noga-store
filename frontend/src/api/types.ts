/**
 * Тип, представляющий поддерживаемые HTTP-методы.
 *
 * Используется для строгой типизации методов запросов в API.
 */
export type HttpMethod = "GET" | "POST";

/**
 * Интерфейс, определяющий опций для API-запросов.
 *
 * Определяет дополнительные параметры, которые могут быть переданы
 * при вызове функций работы с API.
 */
export interface IApiOptions {
	/**
	 * Заголовки HTTP-запроса.
	 *
	 * @default undefined
	 *
	 * @example
	 * { "Content-Type": "application/json", "Authorization": "Bearer token" }
	 */
	headers?: HeadersInit;

	/**
	 * Таймаут запроса в миллисекундах.
	 *
	 * Определяет максимальное время ожидания ответа от сервера.
	 * Если ответ не получен за указанное время, запрос прерывается.
	 *
	 * @default 5000
	 *
	 * @example 10_000
	 */
	timeout?: number;
}

/**
 * Интерфейс конфигурации запроса, расширяющий стандартный {@link RequestInit}.
 */
export interface IFetchConfig extends RequestInit {
	/**
	 * Таймаут запроса в миллисекундах.
	 *
	 * Если указан, запрос будет прерван, если не завершится в течение
	 * заданного времени. Используется для предотвращения зависаний.
	 *
	 * @default undefined
	 *
	 * @example 15_000
	 */
	timeout?: number;
}

// =============================================================================
// --- ТИПЫ И ИНТЕРФЕЙСЫ, СВЯЗАННЫЕ С КАСТОМНЫМИ ХУКАМИ РАБОТЫ С API

/**
 * Интерфейс возвращаемого значения хука {@link useApiGet}.
 *
 * Описывает структуру объекта, возвращаемого кастомным хуком для управления
 * состоянием GET-запроса к API.
 */
export interface IUseGetReturns<T> {
	/**
	 * Данные, полученные от API.
	 *
	 * Содержит результат запроса строго типизированного по `T`.
	 * Изначально `null`, до завершения первого запроса.
	 *
	 * @example
	 * [{ id: 1, name: "Товар" }, { id: 2, name: "Товар 2" }]
	 */
	data: T | null;

	/**
	 * Флаг состояния загрузки.
	 *
	 * Равен `true`, пока выполняется запрос. Используется для отображения
	 * индикатора загрузки в интерфейсе.
	 *
	 * @default true
	 */
	loading: boolean;

	/**
	 * Объект ошибки, если запрос завершился неудачно.
	 *
	 * Содержит экземпляр `Error` при возникновении проблемы (сетевая ошибка,
	 * неверный ответ и т.д.). В противном случае — `null`.
	 *
	 * @default null
	 */
	error: Error | null;

	/**
	 * Функция для повторного выполнения запроса.
	 *
	 * Позволяет принудительно обновить данные, например, при действиях
	 * пользователя (кнопка "Обновить") или изменении зависимости, не влияя
	 * на `url` или `options`.
	 */
	refetch: () => void;
}

/**
 * Тип функции для выполнения HTTP-запроса.
 *
 * @template T - Тип ожидаемого ответа от сервера.
 *
 * @param url - URL-адрес, по которому будет выполнен запрос.
 * @param body - Тело запроса, может быть любого типа (обычно объект, строка 
 * или `null`).
 * @param options - Необязательные параметры запроса, такие как заголовки, 
 * метод, таймаут и т.д.
 *
 * @returns Промис, который разрешается с данными типа `T` в случае 
 * успешного ответа.
 *
 * @example
 * const fetchData: ExecuteFuncType<UserData> = async (url, body, options) => {
 *   const response = await fetch(url, { ...options, body: JSON.stringify(body) });
 *   return response.json() as T;
 * };
 */
export type ExecuteFuncType<T> = (
	url: string,
	body: unknown,
	options?: IApiOptions,
) => Promise<T>;

/**
 * Интерфейс, описывающий возвращаемое значение хука {@link useApiPost}.
 *
 * @template T - Тип данных, которые будут получены в результате выполнения 
 * запроса.
 */
export interface IUsePostReturns<T> {
	/**
	 * Данные, полученные от сервера. 
	 * 
	 * Изначально равны `null`. После успешного выполнения запроса содержит 
	 * данные типа `T`.
	 */
	data: T | null;

	/**
	 * Флаг состояния загрузки.
	 * 
	 * Принимает значение `true`, если запрос в процессе выполнения, 
	 * и `false` — если завершён.
	 */
	loading: boolean;

	/**
	 * Объект ошибки, возникшей при выполнении запроса. 
	 * 
	 * Если ошибки нет — значение `null`.
	 */
	error: Error | null;

	/**
	 * Функция для выполнения HTTP-запроса.
	 * 
	 * Может быть вызвана отдельно для отправки данных на сервер.
	 * Принимает URL, тело запроса и опциональные параметры.
	 *
	 * @see {@link ExecuteFuncType}
	 */
	execute: ExecuteFuncType<T>;
}
